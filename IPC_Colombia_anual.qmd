---
title: "CPI Colombia"
subtitle: "Total and Core inflation"
date: today
author: "Miguel Martinez"
format: 
  html:
    toc: true
    theme: cosmo
editor: visual
execute:
  warning: false
---

This document describes the process of building different visualizations of the evolution of the total and core inflation (inflation without foods, energy and other regulated) according to the Consumer Price Index (CPI) in Colombia which is made public by the Departamento Administrativo Nacional de Colombia ([DANE](https://www.dane.gov.co/)). You can download the data [here](https://www.dane.gov.co/index.php/estadisticas-por-tema/precios-y-costos/indice-de-precios-al-consumidor-ipc):

The first step is to load the following libraries:

```{r}

library(readxl)
library(tidyverse)
library(janitor)
```

## Load data

Now, we are going to load the data:

```{r}

# Total inflation

df1 = readxl::read_excel("anex-IPC-Indices-oct2025.xlsx",
                         sheet = "IndicesIPC",
                         range = "A9:X21",
                         col_names = TRUE)

# Core inflation

df2 = readxl::read_excel("anex-IPC-sinAlimentosRegulados-sep2025.xlsx",
                         sheet = "2",
                         range = "A7:F89",
                         col_names = TRUE)
```

## Indexing, renaming and dtype transformation

```{r}

# Now we are going to omit some rows, rename some columns, and set columns as numeric

df2 = df2[-c(1:12), ] |>
  dplyr::rename(
    variacion_mensual = 4,
    variacion_ano_corrido = 5,
    variacion_anual = 6) |>
  janitor::clean_names() |>
  dplyr::mutate_at(vars(4:6), as.numeric)
```

## Reshape and dtype transformation

Now we are going to reshape the total inflation's database in order to represent individual values by a single row (*stacked*)

```{r}

df1 = df1 |> 
  tidyr::pivot_longer(cols = `2003`:`2025`,
                      names_to = "ano") |>
  janitor::clean_names() |>
  dplyr::mutate_at(vars(ano), as.numeric)

df1
```

## Percentage change

Since total CPI is expresed in levels, we are going to compute the percentage change.

```{r}

df1 = df1 |>
  dplyr::mutate(
    value = (value / lag(value, n = 1) - 1) * 100)

```

## Merging Dataframes

Since core inflation's data is lagged 1 period regarding to total inflation, we are joining both databases with `left_join` function of `dplyr`:

```{r}

data = df1 |>
  tidyr::drop_na() |> 
  dplyr::left_join(df2,
                   by = join_by(ano, mes))

data
```

## Reshape, rename and transform

As before, we are reshaping the data to the *long* or *stacked* format:

```{r}

data = data |> 
  dplyr::select(mes, ano, value, variacion_anual) |> 
  dplyr::rename(
     inflacion_total = value,
     inflacion_core = variacion_anual) |> 
  tidyr::pivot_longer(cols = 3:4,
                      names_to = "inflation_type",
                      values_to = "value") |> 
  dplyr::mutate(
    mes = recode(mes,
                 "Enero" = 01, "Febrero" = 02,
                 "Marzo" = 03, "Abril" = 04,
                 "Mayo" = 05, "Junio" = 06,
                 "Julio" = 07, "Agosto" = 08,
                 "Septiembre" = 09, "Octubre" = 10,
                 "Noviembre" = 11, "Diciembre" = 12))

data
```

## Filtering

```{r}

# We filter the data from 2020

data = data |> 
  dplyr::filter(ano >= 2020)
```

## Total inflation

```{r}

# Before we need to rename, filter, and transform 'Mes' in df1

df1 = df1 |> 
  dplyr::rename(inflacion_total = value) |> 
  dplyr::filter(ano >= 2020) |> 
  dplyr::mutate(
    mes = recode(mes,
                 "Enero" = 01, "Febrero" = 02,
                 "Marzo" = 03, "Abril" = 04,
                 "Mayo" = 05, "Junio" = 06,
                 "Julio" = 07, "Agosto" = 08,
                 "Septiembre" = 09, "Octubre" = 10,
                 "Noviembre" = 11, "Diciembre" = 12))

```

```{r}

shadedarea <- 3  #Targeting inflation by Colombian Central bank

df1 |> 
ggplot(aes(x = mes, y = inflacion_total)) +
  geom_point() +
  geom_line() +
  geom_hline(yintercept = shadedarea, color = "grey", lwd = 20, alpha = 0.4) +
  facet_grid( . ~ ano) +
  scale_x_continuous(breaks = seq(0,12, by=2)) +
  scale_y_continuous(breaks = seq(0,15, by=1)) +
  theme_classic() +
  labs(title = "Índice de precios al consumidor, 2020-2025",
       subtitle = "(variación anual, fin de periodo)",
       x = "Meses",
       y = "Variación (%)",
       caption = "Fuente: Elaboración propia con datos del DANE, IPC") +
  theme(plot.caption.position = "panel",
        plot.caption = element_text(hjust = 0))

```

## Core inflation

```{r}

# First we need to select, rename, filter, and transform 'Mes' in df2

df2 = df2 |>
  dplyr::select(ano, mes, variacion_anual) |> 
  dplyr::rename(inflacion_core = variacion_anual) |> 
  dplyr::filter(ano >= 2020) |> 
  dplyr::mutate(
    mes = recode(mes,
                 "Enero" = 01, "Febrero" = 02,
                 "Marzo" = 03, "Abril" = 04,
                 "Mayo" = 05, "Junio" = 06,
                 "Julio" = 07, "Agosto" = 08,
                 "Septiembre" = 09, "Octubre" = 10,
                 "Noviembre" = 11, "Diciembre" = 12))

```

```{r}

shadedarea <- 3  #Targeting inflation by Colombian Central bank

df2 |> 
ggplot(aes(x = mes, y = inflacion_core)) +
  geom_point() +
  geom_line() +
  geom_hline(yintercept = shadedarea, color = "grey", lwd = 22, alpha = 0.4) +
  facet_grid( . ~ ano) +
  scale_x_continuous(breaks = seq(0,12, by=2)) +
  scale_y_continuous(breaks = seq(0,12, by=1)) +
  theme_classic() +
  labs(title = "Índice de precios al consumidor sin alimentos ni regulados, 2020-2025",
       subtitle = "(variación anual, fin de periodo)",
       x = "Meses",
       y = "Variación (%)",
       caption = "Fuente: Elaboración propia con datos del DANE, IPC") +
  theme(plot.caption.position = "panel",
        plot.caption = element_text(hjust = 0))

```

## Total and core inflation

```{r}

shadedarea <- 3  #Targeting inflation by Colombian Central bank

data |> 
ggplot(aes(x = mes, y = value, colour = inflation_type)) +
  geom_point() +
  geom_line() +
  geom_hline(yintercept = shadedarea, color = "grey", lwd = 16, alpha = 0.4) +
  facet_grid( . ~ ano) +
  scale_x_continuous(breaks = seq(0,12, by=2)) +
  scale_y_continuous(breaks = seq(0,14, by=1)) +
  theme_classic() +
  labs(title = "Índice de precios al consumidor total y sin Alimentos ni Regulados, 2020-2025",
       subtitle = "(variación anual, fin de periodo)",
       x = "Meses",
       y = "Variación (%)",
       caption = "Fuente: Elaboración propia con datos del DANE, IPC") +
  theme(plot.caption.position = "panel",
        plot.caption = element_text(hjust = 0),
        legend.position = "bottom")

```

## Conclusion

As you can see in the hard years of the pandemic (2020, 2021) the inflation measurements remained quite stable in the targeting inflation policy by the independent Colombian central bank: Banco de la República ([Banrep](https://www.banrep.gov.co/es/glosario/inflacion-objetivo)) or even a few periods below the targeting (represented by the gray shaded area). Although the following years due to the rebound effect of the national economy, we are still observing high inflation in the goods and services of the economy. This is an ongoing concern because this not only affect households, but also companies, governments and other agents in the economy. In other hand, the Colombian Banrep board of directors are expecting the return of the targeting inflation in the year 2025 according to the [last minutes](https://www.banrep.gov.co/es/noticias/minutas-banrep-octubre-2025).
